<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Edit Workspace Name</title>
	<style>
		body {
			font-family: sans-serif;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			height: 100vh;
			margin: 0;
			background-color: var(--vscode-editor-background);
		}

		h2 {
			color: var(--vscode-editor-foreground);
		}

		.container {
			width: 600px;
			height: 400px;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			background: var(--vscode-sideBar-background);
			border-radius: 8px;
			box-shadow: 0 2px 16px rgba(0, 0, 0, 0.2);
		}

		label,
		input {
			color: var(--vscode-editor-foreground);
			font-size: 1.2em;
		}

		input {
			width: 80%;
			padding: 8px;
			margin: 16px 0;
			border-radius: 4px;
			border: 1px solid var(--vscode-input-border);
			background: var(--vscode-input-background);
			color: var(--vscode-input-foreground);
		}

		button {
			margin: 8px;
			padding: 8px 24px;
			font-size: 1em;
			border-radius: 4px;
			border: none;
			background: var(--vscode-button-background);
			color: var(--vscode-button-foreground);
			cursor: pointer;
		}

		button:hover {
			background: var(--vscode-button-hoverBackground);
		}

		@media (prefers-color-scheme: dark) {
			body {
				background-color: var(--vscode-editor-background);
			}
			.container {
				background: var(--vscode-sideBar-background);
			}
		}

		@media (prefers-color-scheme: light) {
			body {
				background-color: var(--vscode-editor-background);
			}
			.container {
				background: var(--vscode-sideBar-background);
			}
		}
	</style>
</head>

<body>
	<div class="container">
		<h2>Edit Workspace</h2>
		<input id="workspaceName" type="text" value="" autofocus />
		<h3>Project Paths</h3>
		<table id="projectPathsTable" style="width:80%;margin-bottom:16px;">
			<thead>
				<tr>
					<th style="text-align:left;">Path</th>
					<th style="text-align:left;">Actions</th>
				</tr>
			</thead>
			<tbody id="projectPathsBody">
				<!-- Project paths will be inserted here -->
			</tbody>
		</table>
		<button id="addPathBtn">Add Project Path</button>
		<div style="margin-top:16px;">
			<button id="saveBtn">Save</button>
			<button id="cancelBtn">Cancel</button>
		</div>
	</div>
	<script>
		const vscode = acquireVsCodeApi();

		// Store project paths in memory
		let projectPaths = [];

		// Load initial projectPaths from VS Code extension
		if (window.initialProjectPaths && Array.isArray(window.initialProjectPaths)) {
			projectPaths = window.initialProjectPaths;
		}

		function renderProjectPaths() {
			const tbody = document.getElementById('projectPathsBody');
			tbody.innerHTML = '';
			projectPaths.forEach((path, idx) => {
				const tr = document.createElement('tr');
				const tdPath = document.createElement('td');
				tdPath.textContent = path;
				const tdActions = document.createElement('td');
				const removeBtn = document.createElement('button');
				removeBtn.textContent = 'Remove';
				removeBtn.onclick = () => {
					projectPaths.splice(idx, 1);
					renderProjectPaths();
				};
				tdActions.appendChild(removeBtn);
				tr.appendChild(tdPath);
				tr.appendChild(tdActions);
				tbody.appendChild(tr);
			});
		}

		document.getElementById('addPathBtn').onclick = () => {
			vscode.postMessage({ command: 'chooseFolder' });
		};

		window.addEventListener('message', event => {
			const message = event.data;
			if (message.command === 'addPath' && message.path) {
				projectPaths.push(message.path);
				renderProjectPaths();
			}
		});

		document.getElementById('saveBtn').onclick = () => {
			const newName = document.getElementById('workspaceName').value;
			vscode.postMessage({ command: 'save', newName, projectPaths });
		};
		document.getElementById('cancelBtn').onclick = () => {
			vscode.postMessage({ command: 'cancel' });
		};

		renderProjectPaths();
	</script>
</body>

</html>